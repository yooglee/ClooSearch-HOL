![image](https://user-images.githubusercontent.com/113465005/226238596-cc76039e-67c2-46b6-b0bb-35d037ae66e1.png)

# ClooSearch powered by: Azure Search + Azure OpenAI + Bot Framework + Langchain + Azure SQL + CosmosDB + Bing Search API
[![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://codespaces.new/MSUSAzureAccelerators/Azure-Cognitive-Search-Azure-OpenAI-Accelerator?quickstart=1)
[![Open in VS Code Dev Containers](https://img.shields.io/static/v1?style=for-the-badge&label=Remote%20-%20Containers&message=Open&color=blue&logo=visualstudiocode)](https://vscode.dev/redirect?url=vscode://ms-vscode-remote.remote-containers/cloneInVolume?url=https://github.com/MSUSAzureAccelerators/Azure-Cognitive-Search-Azure-OpenAI-Accelerator)

ë³¸ Hands-on-Labì—ëŠ” ë‹¤ì–‘í•œ ìœ„ì¹˜ì— í©ì–´ì ¸ ìˆëŠ” ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ë°ì´í„°ë¥¼ ì´í•´í•  ìˆ˜ ìˆëŠ” Multi-Channel Smart Chatbot ë° ê²€ìƒ‰ ì—”ì§„ì´ í•„ìš”í•˜ë©°, ë˜í•œ ëŒ€í™”í˜• ì±—ë´‡ì€ ë¬¸ì˜ì— ëŒ€í•œ ë‹µë³€ê³¼ í•¨ê»˜ ì¶œì²˜ ë° ë‹µë³€ì„ ì–»ì„ ìˆ˜ ìˆëŠ” ë°©ë²• ë° ìœ„ì¹˜ì— ëŒ€í•œ ì„¤ëª…ì„ ì œê³µí•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì¦‰, ê·€ì‚¬ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„°ì— ëŒ€í•œ ì§ˆë¬¸ì„ í•´ì„, ì´í•´ ë° ë‹µë³€í•  ìˆ˜ ìˆëŠ” í”„ë¼ì´ë¹— ë° ë³´ì•ˆ ChatGPT êµ¬ì¶•ì„ ëª©í‘œë¡œ í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ì´ Hands-on-Labì˜ ëª©í‘œëŠ”

1. Bot Frameworkë¡œ êµ¬ì¶•ë˜ì–´ ì—¬ëŸ¬ ì±„ë„(Web Chat, MS Teams, SMS, Email, Slack ë“±)ì— ë™ê¸°í™” í•  ìˆ˜ ìˆëŠ” Backend Bot API êµ¬ì„±
2. ê²€ìƒ‰ê³¼ ë´‡ UIê°€ ìˆëŠ” í”„ë¡ íŠ¸ì—”ë“œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì„± 

ì´ ë‘ê°œì§€ì˜ Goalsì„ í†µí•˜ì—¬ ì‚¬ìš©ì ìì‹ ë§Œì˜ ë°ì´í„°ë¥¼ êµ¬ì¶•ëœ ChatBotì„ í†µí•´ ë³´ì—¬ì£¼ëŠ” ê²ƒ ì…ë‹ˆë‹¤.

**For Microsoft FTEs:** This is a customer funded VBD, below the assets for the delivery.

| **Item**                   | **Description**                                                                                                     | **Link**                                                                                                                                                |
|----------------------------|---------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| VBD SKU Info and Datasheet                   | CSAM must dispatch it as "Customer Invested" against credits/hours of Unified Support Contract. Customer decides if 3 or 5 days.                                      | [ESXP SKU page](https://esxp.microsoft.com/#/omexplanding/services/14486/geo/USA/details/1)                                                                                              |
| VBD Accreditation for CSAs     | Links for CSAs to get the Accreditation needed to deliver the workshop                                                                      | [Link 1](https://learningplayer.microsoft.com/activity/s9261799/launch) , [Link 2](https://learningplayer.microsoft.com/activity/s9264662/launch) |
| VBD 3-5 day POC Asset (IP)  | The MVP to be delivered  (this GitHub repo)                                     | [Azure-Cognitive-Search-Azure-OpenAI-Accelerator](https://github.com/MSUSAzureAccelerators/Azure-Cognitive-Search-Azure-OpenAI-Accelerator)                |
| VBD Workshop Deck          | The deck introducing and explaining the workshop                                                                    | [Intro AOAI GPT Azure Smart Search Engine Accelerator.pptx](https://github.com/MSUSAzureAccelerators/Azure-Cognitive-Search-Azure-OpenAI-Accelerator/blob/main/Intro%20AOAI%20GPT%20Azure%20Smart%20Search%20Engine%20Accelerator.pptx) |
| CSA Training Video         | 2 Hour Training for Microsoft CSA's                                                                    | [POC VBD Training Recording](https://microsoft.sharepoint.com/teams/CSUDataAI/_layouts/15/stream.aspx?id=%2Fteams%2FCSUDataAI%2FShared%20Documents%2FTech%20Talk%2FAI%20%26%20ML%2FAOAI%203%2DDay%20Workshop%20Training%2FAzure%20OpenAI%20%5F%20VBD%20Delivery%20Training%20%5F%20Option%201%2D20230607%5F090249%2DMeeting%20Recording%20%281%29%2Emp4&referrer=Teams%2ETEAMS%2DELECTRON&referrerScenario=p2p%5Fns%2Dbim&ga=1) |


---
**Hands on Labì„ ìœ„í•œ ì‚¬ì „ í•„ìˆ˜ í•­ëª©**
* ì• ì € êµ¬ë… (Azure subscription)
* GPT-4ë¥¼ í¬í•¨í•œ Azure Open AIì— ëŒ€í•œ ì‹ ì²­ ìŠ¹ì¸.
* ì‚¬ìš©ìëŠ” í•´ë‹¹ ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ì— ëŒ€í•œ ê¸°ì—¬ì ì´ìƒì˜ ê¶Œí•œ 
* Resource Group ìƒì„±.
* ë©€í‹° í…Œë„ŒíŠ¸(Multi-tenant) ì•± ë“±ë¡(ì„œë¹„ìŠ¤ ì£¼ì²´).

---
# ì•„í‚¤í…ì³ 
![Architecture](https://github.com/MSUSAzureAccelerators/Azure-Cognitive-Search-Azure-OpenAI-Accelerator/blob/main/images/GPT-Smart-Search-Architecture.jpg)

## Flow
1. ì‚¬ìš©ìê°€ ì§ˆë¬¸ì„ ì…ë ¥í•©ë‹ˆë‹¤.
2. ì•±ì—ì„œ OpenAIì˜ GPT-4ëª¨ë¸ì€ LLMìœ¼ë¡œì¨ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì„ ê¸°ë°˜ìœ¼ë¡œ ê°€ì¥ ì í•©í•œ ë‹µì„ ì°¾ì„ ì†ŒìŠ¤ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. 
3. ë„¤ ê°€ì§€ ìœ í˜•ì˜ ì†ŒìŠ¤:
   * 3a. Azure SQL Database 
   * 3b. Azure Bing Search API (ì¸í„°ë„· ì ‘ê·¼) 
   * 3c. Azure Cognitive Search
      * 3c.1. OpenAIì„ ì‚¬ìš©í•˜ì—¬ ìƒìœ„ Kê°œ ë¬¸ì„œ ì²­í¬ë¥¼ ë²¡í„°í™”í•©ë‹ˆë‹¤. 
      * 3c.2. ë²¡í„° ê¸°ë°˜ ì¸í…ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
      * 3c.3. ë²¡í„° ê¸°ë°˜ ì¸ë±ìŠ¤ì— ëŒ€í•´ ë²¡í„° ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ì—¬ ìƒìœ„ Nê°œ ì²­í¬ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
   * 3d. CSV Tabular File 
4. ì‚¬ìš©ì ì§ˆë¬¸ì„ ê¸°ë°˜ìœ¼ë¡œ ì•±ì€ ì†ŒìŠ¤ë¡œë¶€í„° ê²°ê³¼ë¥¼ ê²€ìƒ‰í•˜ê³  ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤. 
5. íŠœí”Œ(Question and Answer)ì€ CosmosDBì— ì €ì¥ë˜ì–´ ëŒ€í™”ë‚´ìš©ì„ ê¸°ì–µ ë° ì¶”ê°€ ë¶„ì„ì„ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
6. ë‹µë³€ì„ ì‚¬ìš©ì ì „ë‹¬í•©ë‹ˆë‹¤. 

---
## Microsoft ë°ëª¨

https://gptsmartsearch.azurewebsites.net/

ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ íŒ€ì˜ ë°ëª¨ë´‡ì„ ì—´ë ¤ë©´ [ì—¬ê¸°](https://teams.microsoft.com/l/chat/0/0?users=28:5d583679-8196-4673-9d77-c294c010bca5)ë¥¼ í´ë¦­í•˜ì„¸ìš”. 

---

## ğŸ”§**íŠ¹ì„±**

   - [Bot Framework](https://dev.botframework.com/) ë° [Bot Service](https://azure.microsoft.com/en-us/products/bot-services/)ë¥¼ ì‚¬ìš©í•˜ì—¬ Bot API ë°±ì—”ë“œë¥¼ í˜¸ìŠ¤íŒ…í•˜ê³  MS Teamsë¥¼ í¬í•¨í•œ ì—¬ëŸ¬ ì±„ë„ì— ì ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
   - 100% Python.
   - [Azure Cognitive Services](https://azure.microsoft.com/en-us/products/cognitive-services/)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì–¸ì–´ íƒì§€, OCR ì´ë¯¸ì§€, í‚¤ êµ¬ë¬¸ ì¶”ì¶œ, ê°œì²´ ì¸ì‹(ì¸ë¬¼, ì´ë©”ì¼, ì£¼ì†Œ, ì¡°ì§, URL) ë“± ë¹„ì •í˜• ë¬¸ì„œë¥¼ ìƒ‰ì¸í™”í•˜ê³  í’ë¶€í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.
   - Azure Cognitive Searchì˜ ë²¡í„° ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ê°€ì¥ ì í•©í•œ ë‹µë³€ì„ ì œê³µí•©ë‹ˆë‹¤.
   - ì‚¬ìš©ìê°€ ì‹œìŠ¤í…œê³¼ ìƒí˜¸ ì‘ìš©í•  ë•Œ í•„ìš”ì— ë”°ë¼ ë²¡í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
   - [LangChain](https://langchain.readthedocs.io/en/latest/)ì„ ì‚¬ìš©í•˜ì—¬ Azure OpenAIì™€ ìƒí˜¸ ì‘ìš©í•˜ê³  í”„ë¡¬í”„íŠ¸ë¥¼ êµ¬ì„±í•˜ì—¬ ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ë˜í¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
   - ë‹¤êµ­ì–´ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.
   - ë©€í‹° ì¸ë±ìŠ¤ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. 
   - CSV íŒŒì¼ ë° SQL Flavor ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•œ í‘œ í˜•íƒœì˜ ë°ì´í„°ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.
   - [Azure AI Document Intelligence SDK (former Form Recognizer)](https://learn.microsoft.com/en-us/azure/ai-services/document-intelligence/overview?view=doc-intel-3.0.0)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•˜ê³  ê·œëª¨ê°€ í° PDF ë¬¸ì„œë¥¼ íŒŒì‹±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   - [Bing Search API](https://www.microsoft.com/en-us/bing/apis)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸í„°ë„· ê²€ìƒ‰ ë° ê³µê°œ ì›¹ì‚¬ì´íŠ¸ ì§ˆì˜ì‘ë‹µì„ ì§€ì›í•©ë‹ˆë‹¤.
   - CosmosDBë¥¼ ì˜êµ¬ ë©”ëª¨ë¦¬ë¡œ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ëŒ€í™”ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
   - [Streamlit](https://streamlit.io/)ì„ ì‚¬ìš©í•˜ì—¬ Frontend ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ pythonìœ¼ë¡œ êµ¬ì¶•í•©ë‹ˆë‹¤.
   

---

## **Hands-On-Labì˜ ì‹¤í–‰ë‹¨ê³„**

Note: (Pre-requisite) You need to have an Azure OpenAI service already created

1. Fork this repo to your Github account.
2. Azure OpenAI ìŠ¤íŠœë””ì˜¤ì—ì„œ ë‹¤ìŒ ëª¨ë¸ì„ ë°°í¬í•©ë‹ˆë‹¤. ** ë°°í¬ ì´ë¦„ì´ ëª¨ë¸ ì´ë¦„ê³¼ ë™ì¼í•œì§€ í™•ì¸í•©ë‹ˆë‹¤.**
   - "gpt-35-turbo"
   - "gpt-35-turbo-16k"
   - "gpt-4"
   - "gpt-4-32k"
   - "text-embedding-ada-002"
3. Create a Resource Group where all the assets of this accelerator are going to be. Azure OpenAI can be in different RG or a different Subscription.
4. Hands-on-Lab ì‹¤í–‰ì— í•„ìš”í•œ Azure Infrastructure(Azure Cognitive Search, Cognitive Services ë“±)ë¥¼ ëª¨ë‘ ë§Œë“¤ë ¤ë©´ ì•„ë˜ë¥¼ í´ë¦­í•˜ì‹­ì‹œì˜¤:

[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fpablomarin%2FGPT-Azure-Search-Engine%2Fmain%2Fazuredeploy.json) 

**Note**: ë§Œì•½ ì‚¬ìš©ìì˜ êµ¬ë…ì— 'Cognitive services multi-Service account'ê°€ ì—†ëŠ” ê²½ìš°, ìˆ˜ë™ìœ¼ë¡œ azure portalì— ë§Œë“¤ê³  Responsible AIë¥¼ ì½ê³  ë™ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.

5. Clone your Forked repo to your AML Compute Instance. If your repo is private, see below in Troubleshooting section how to clone a private repo.

6. **Python 3.10 conda í™˜ê²½**ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤. 
7. Conda í™˜ê²½ì„ ìƒˆë¡œ ë§Œë“¤ê³ , activate ì‹œì¼œì¤ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ conda í™˜ê²½ì— í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì„ ì„¤ì¹˜ì‹œì¼œ ì¤ë‹ˆë‹¤. 
```
conda create -n <í™˜ê²½ëª…> python=3.10
conda activate <í™˜ê²½ëª…>
pip install -r ./common/requirements.txt
```
ì„¤ì¹˜í• ë•Œ, ì¼ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ dependancies ì˜¤ë¥˜ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì˜¤ë¥˜ì— ê´€ê³„ì—†ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì¹˜ë˜ì—ˆìœ¼ë‹ˆ ì•ˆì‹¬í•˜ì‹œê³  ë„˜ì–´ê°€ì‹œë©´ ë©ë‹ˆë‹¤. 

8. 4ë‹¨ê³„ì—ì„œ ìƒì„±ëœ Azure Infrastructure ì„œë¹„ìŠ¤ë“¤ì„ ì‚¬ìš©í•˜ì—¬ 'credentials.env'íŒŒì¼ì„ ì‚¬ìš©ì ìì‹ ì˜ ê°’ìœ¼ë¡œ í¸ì§‘í•©ë‹ˆë‹¤.
9. **ë…¸íŠ¸ë¶ì„ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤**. ë…¸íŠ¸ë¶ì€ ì„œë¡œ ìƒí˜¸ì‘ìš©ì„ í•˜ê¸° ë•Œë¬¸ì— ê¼­ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ì„ í•´ì£¼ì„¸ìš”. 

